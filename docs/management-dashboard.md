# Management Dashboard

The management dashboard is the organizer-facing interface for administering a conference. It lives under the `/manage/` URL prefix (configured in your project's `urls.py`) and requires authentication. All conference-scoped pages sit under `/manage/<conference-slug>/`.

Access is restricted to users who meet at least one of these criteria:

- Django superuser
- Holds the `program_conference.change_conference` permission
- Belongs to a designated permission group (the financial dashboard additionally accepts the "Program: Finance & Accounting" group)

The sidebar organizes features into sections: **Content** (sections, rooms, speakers, talks, schedule, overrides), **Registration** (financial overview, orders, ticket types, add-ons, vouchers), **Sponsors** (levels, sponsors), and **Programs** (activities, travel grants).

---

## Financial Overview

The financial overview dashboard gives organizers a single-page summary of revenue, orders, payments, and ticket sales for a conference.

**URL**: `/manage/<conference-slug>/financial/`

Navigate to it from the sidebar under **Registration > Financial**.

### Summary Cards

Four headline metrics appear at the top of the page:

| Card | What It Shows |
|---|---|
| **Net Revenue** | Gross revenue from paid orders minus total refunds. Gross revenue is shown beneath when refunds exist. |
| **Total Orders** | Count of all orders in any status. Shows the paid count below when paid orders exist. |
| **Active Carts** | Number of open, non-expired carts. |
| **Credits Outstanding** | Remaining spendable balance of available credits. Shows the total applied amount beneath. |

Net revenue is calculated as: `SUM(total) of paid orders - SUM(amount) of credits linked to source orders`. Refund amounts come from `Credit` records tied to source orders rather than summing refunded order totals, so partial refunds are counted accurately.

### Orders by Status

A table breaking down order counts by status: **Paid**, **Pending**, **Refunded**, **Partial Refund**, and **Cancelled**.

### Carts by Status

Counts for each cart state: **Active** (open and not expired), **Checked Out**, **Expired**, and **Abandoned**.

### Payments by Method

For each payment method (Stripe, manual, etc.), the dashboard shows the number of payments and total dollar amount collected through that method.

### Ticket Type Sales

A per-ticket-type breakdown showing:

- **Ticket Type** name
- **Price** per unit
- **Sold** count (tickets on paid and partially-refunded orders)
- **Remaining** inventory (or an infinity symbol for uncapped ticket types)
- **Revenue** generated by that ticket type

### Recent Orders

The 20 most recent orders across all statuses, showing reference number (linked to the order detail page), user email, status badge, total, and creation date.

### Active Carts

All currently open, non-expired carts listing the user, item count, creation time, and expiration time.

---

## Voucher Management

### Bulk Code Generation

Generate a batch of voucher codes from a single form instead of creating them one at a time.

**URL**: `/manage/<conference-slug>/vouchers/bulk/generate/`

Navigate to it from the voucher list page or go directly to the URL. After generation, the dashboard redirects to the voucher list with a success message.

### Form Fields

| Field | Required | Description |
|---|---|---|
| **Prefix** | Yes | A fixed string prepended to every generated code (max 20 characters). Use something descriptive like `SPEAKER-` or `SPONSOR-`. |
| **Count** | Yes | Number of codes to create. Minimum 1, maximum 500. |
| **Voucher Type** | Yes | The discount model: **Complimentary** (100% off), **Percentage discount**, or **Fixed amount discount**. |
| **Discount Value** | Yes | The percentage (0--100) or fixed dollar amount. Ignored for comp vouchers. Defaults to 0. |
| **Applicable Ticket Types** | No | Restrict these vouchers to specific ticket types. Leave unchecked for all ticket types. Rendered as checkboxes scoped to the current conference. |
| **Applicable Add-ons** | No | Restrict these vouchers to specific add-ons. Leave unchecked for all add-ons. Rendered as checkboxes scoped to the current conference. |
| **Max Uses** | Yes | Maximum number of times each individual code can be redeemed. Defaults to 1. |
| **Valid From** | No | Start of the validity window (datetime picker). Leave blank for immediately valid. |
| **Valid Until** | No | End of the validity window (datetime picker). Leave blank for no expiration. |
| **Unlocks Hidden Tickets** | No | When checked, these vouchers reveal ticket types that are hidden behind a voucher requirement. |

### Generated Code Format

Each code follows the pattern `{prefix}{8 random characters}`. The random portion uses uppercase letters and digits (A-Z, 0-9) generated with `secrets.choice` for cryptographic randomness. Codes are checked against existing vouchers for the same conference and prefix before insertion.

All vouchers in the batch are created in a single database transaction. If any step fails, the entire batch is rolled back and no partial codes are left behind.

### After Generation

On success, the form redirects to the voucher list at `/manage/<conference-slug>/vouchers/` and displays a message confirming how many codes were created and the prefix used. Each generated voucher appears in the standard voucher list where it can be individually edited.

---

## Other Dashboard Features

The management sidebar exposes several additional views beyond financial reporting and voucher generation:

**Content**

- **Dashboard** -- Conference overview with key stats and quick actions.
- **Settings** -- Edit conference name, dates, slug, and configuration.
- **Sections** -- Create and manage conference sections (tracks or categories).
- **Rooms** -- Manage physical or virtual rooms for scheduling.
- **Speakers** -- Browse and view speaker profiles synced from Pretalx.
- **Talks** -- List, filter by submission type, view details, and edit talks. The sidebar shows submission type sub-navigation with counts.
- **Schedule** -- View and edit schedule slots.
- **Overrides** -- Override Pretalx-synced data for talks, speakers, rooms, sponsors, and submission type defaults.

**Registration**

- **Orders** -- Full order list with filtering, detail views, and manual payment recording.
- **Ticket Types** -- Create and edit ticket types with pricing, availability windows, and stock limits.
- **Add-ons** -- Manage conference add-ons (t-shirts, tutorials, etc.).
- **Vouchers** -- Individual voucher CRUD alongside the bulk generation tool.

**Sponsors**

- **Levels** -- Define sponsorship tiers and their associated benefits.
- **Sponsors** -- Manage individual sponsors and their level assignments.

**Programs**

- **Activities** -- Create sprints, tutorials, and open spaces with signup caps. Includes per-activity dashboards with attendee export and waitlist promotion.
- **Travel Grants** -- Review applications, send messages, and record disbursements. Includes receipt review queue with approve/flag workflow.
